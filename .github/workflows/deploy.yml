name: Deploy CLIFF to Windows VDS

on:
  push:
    branches:
      - main
      - master
  workflow_dispatch:

jobs:
  notify-deployment:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger VDS Webhook
        run: |
          curl -X POST \
            -H "X-Hub-Signature-256: sha256=$(echo -n '{"ref":"refs/heads/main"}' | openssl dgst -sha256 -hmac '${{ secrets.WEBHOOK_SECRET }}' | awk '{print $2}')" \
            -H "Content-Type: application/json" \
            -d '{"ref":"refs/heads/main","repository":{"name":"${{ github.repository }}"}}' \
            ${{ secrets.WEBHOOK_URL }}
      
      - name: Deployment Status
        run: |
          echo "‚úÖ Deployment webhook g√∂nderildi!"
          echo "üåê Site: https://cliff.kynux.dev"
